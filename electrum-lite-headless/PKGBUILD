# Maintainer: Andy Weidenbaum <archbaum@gmail.com>

pkgname=electrum-lite-headless
pkgver=1.9.8
pkgrel=1
pkgdesc="Lightweight Litecoin wallet, headless version"
arch=('any')
depends=('python2' 'python2-ecdsa' 'python2-pbkdf2' 'python2-slowaes')
url="https://electrum-lite.org"
license=('GPL3')
source=(https://electrum-lite.org/Electrum-Lite-$pkgver.tar.gz)
sha256sums=('dda754ec254396eae5f0df2e16f3773fa36f52ad03ec0841c52374cd531538fb')
provides=('electrum-lite')
install=electrum-lite.install

prepare() {
  cd $srcdir/Electrum-Lite-$pkgver

  msg 'Fixing Python version...'
  find . -type f -print0 | xargs -0 sed -i 's#/usr/bin/python#/usr/bin/python2#g'
  find . -type f -print0 | xargs -0 sed -i 's#/usr/bin/env python#/usr/bin/env python2#g'
}

package() {
  cd $srcdir/Electrum-Lite-$pkgver

  msg 'Installing license...'
  install -Dm 644 LICENCE $pkgdir/usr/share/licenses/electrum-lite/LICENSE
  install -Dm 644 AUTHORS $pkgdir/usr/share/licenses/electrum-lite/AUTHORS

  msg 'Installing documentation...'
  for $_doc in README RELEASE-NOTES; do
    install -Dm 644 $_doc $pkgdir/usr/share/doc/electrum-lite/$_doc
  done

  msg 'Installing appdirs...'
  install -dm 755 $pkgdir/usr/share/electrum-lite
  for _appdir in contrib data docs gui icons lib plugins pubkeys scripts; do
    mv $_appdir $pkgdir/usr/share/electrum-lite/$_appdir
  done

  msg 'Installing appfiles...'
  for _appfile in app.fil electrum-lite electrum-lite.conf.sample electrum-lite.desktop electrum.icns icons.qrc Info.plist make_packages MANIFEST.in mki18n.py setup.py setup-release.py; do
    mv $_appfile $pkgdir/usr/share/electrum/$_appfile
  done
}
